<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mermaid Test - Direct Rendering</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 4px;
            border-left: 4px solid #667eea;
        }
        .diagram-container {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #5568d3;
        }
        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ Mermaid.js Client-Side Rendering Test</h1>

        <p><strong>This test verifies that Mermaid diagrams render directly in the browser using mermaid.js</strong></p>

        <div class="test-section">
            <h2>Test 1: Simple Flowchart</h2>
            <button onclick="renderTest1()">Render Flowchart</button>
            <div id="test1" class="diagram-container"></div>
        </div>

        <div class="test-section">
            <h2>Test 2: Sequence Diagram</h2>
            <button onclick="renderTest2()">Render Sequence Diagram</button>
            <div id="test2" class="diagram-container"></div>
        </div>

        <div class="test-section">
            <h2>Test 3: Class Diagram</h2>
            <button onclick="renderTest3()">Render Class Diagram</button>
            <div id="test3" class="diagram-container"></div>
        </div>

        <div class="test-section">
            <h2>Test 4: State Diagram</h2>
            <button onclick="renderTest4()">Render State Diagram</button>
            <div id="test4" class="diagram-container"></div>
        </div>

        <div class="test-section">
            <h2>Test 5: Gantt Chart</h2>
            <button onclick="renderTest5()">Render Gantt Chart</button>
            <div id="test5" class="diagram-container"></div>
        </div>

        <div class="test-section">
            <button onclick="renderAllTests()" style="background: #28a745; font-size: 18px; padding: 15px 30px;">
                ‚úÖ Run All Tests
            </button>
        </div>
    </div>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';

        mermaid.initialize({
            startOnLoad: false,
            theme: 'default',
            securityLevel: 'loose'
        });

        window.renderDiagram = async function(containerId, code, title) {
            const container = document.getElementById(containerId);
            container.innerHTML = '<div style="padding: 20px; color: #666;">Rendering...</div>';

            try {
                const id = `diagram-${containerId}-${Date.now()}`;
                const { svg } = await mermaid.render(id, code);
                container.innerHTML = `
                    <h3 style="color: #667eea; margin-top: 0;">${title}</h3>
                    <div class="status success">‚úÖ Successfully rendered using mermaid.js</div>
                    ${svg}
                `;
            } catch (error) {
                container.innerHTML = `
                    <h3 style="color: #e74c3c;">${title}</h3>
                    <div class="status error">‚ùå Error: ${error.message}</div>
                    <pre>${code}</pre>
                `;
            }
        };

        window.renderTest1 = function() {
            const code = `graph TD
    A[Start] --> B{Is it working?}
    B -->|Yes| C[Great!]
    B -->|No| D[Debug]
    D --> B
    C --> E[End]`;
            renderDiagram('test1', code, 'Flowchart Test');
        };

        window.renderTest2 = function() {
            const code = `sequenceDiagram
    participant User
    participant Frontend
    participant Mermaid.js

    User->>Frontend: Request diagram
    Frontend->>Mermaid.js: render(code)
    Mermaid.js-->>Frontend: SVG
    Frontend-->>User: Display diagram`;
            renderDiagram('test2', code, 'Sequence Diagram Test');
        };

        window.renderTest3 = function() {
            const code = `classDiagram
    class MermaidDiagram {
        +String code
        +String title
        +render()
        +handleCopy()
        +handleDownload()
    }
    class ReactComponent {
        +render()
        +useState()
        +useEffect()
    }
    ReactComponent <|-- MermaidDiagram`;
            renderDiagram('test3', code, 'Class Diagram Test');
        };

        window.renderTest4 = function() {
            const code = `stateDiagram-v2
    [*] --> Idle
    Idle --> Rendering: render()
    Rendering --> Success: diagram rendered
    Rendering --> Error: render failed
    Success --> [*]
    Error --> Idle: retry`;
            renderDiagram('test4', code, 'State Diagram Test');
        };

        window.renderTest5 = function() {
            const code = `gantt
    title Mermaid Implementation Timeline
    dateFormat YYYY-MM-DD
    section Backend
    Remove old code    :done, 2025-10-07, 1d
    section Frontend
    Install mermaid.js :done, 2025-10-07, 1d
    Create component   :done, 2025-10-07, 1d
    Integration        :done, 2025-10-07, 1d
    section Testing
    Run tests          :active, 2025-10-07, 1d`;
            renderDiagram('test5', code, 'Gantt Chart Test');
        };

        window.renderAllTests = function() {
            renderTest1();
            setTimeout(() => renderTest2(), 200);
            setTimeout(() => renderTest3(), 400);
            setTimeout(() => renderTest4(), 600);
            setTimeout(() => renderTest5(), 800);
        };

        // Auto-run first test on load
        setTimeout(() => renderTest1(), 500);
    </script>
</body>
</html>
